<section>
  <h2>Compare</h2>
  <p>Phase 5: scoring + explainability ✅</p>

  <app-driver-multi-picker (selectedChange)="onSelected($event)"></app-driver-multi-picker>

  <div class="controls">
    <label>
      From
      <input type="number" [formControl]="fromCtrl" min="1950" />
    </label>

    <label>
      To
      <input type="number" [formControl]="toCtrl" min="1950" />
    </label>

    <label>
      Mode
      <select [formControl]="modeCtrl">
        <option *ngFor="let m of modes" [value]="m.id">{{ m.label }}</option>
      </select>
    </label>

    <button type="button" (click)="runCompare()" [disabled]="selected.length < 2 || loading">
      {{ loading ? 'Loading…' : 'Compare' }}
    </button>
  </div>

  <div class="error" *ngIf="errorMsg">{{ errorMsg }}</div>

  <ng-container *ngIf="compare$ | async as compare">
    <div *ngIf="compare" class="meta">
      Mode: <strong>{{ compare.mode }}</strong> • Period used: {{ compare.fromSeason }} → {{ compare.toSeason }}
    </div>

    <app-ranking-table
      *ngIf="compare"
      [ranking]="compare.ranking"
      [selectedDrivers]="selected"
    />
  </ng-container>
</section>
